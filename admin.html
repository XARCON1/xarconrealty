<!DOCTYPE html>
<html lang="es-NI">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Panel de administración para generar el archivo properties.json de Xarcon Realty." />
  <meta name="xarcon-maps-key" content="" />
  <title>XARCON REALTY | Admin Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="styles/admin.css" />
</head>
<body>
  <header class="site-header">
    <nav class="navbar container" aria-label="Navegación principal">
      <a class="logo" href="index.html">XARCON <span>REALTY</span></a>
      <button class="menu-toggle" aria-label="Abrir menú" aria-expanded="false">☰</button>
      <ul class="nav-links">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="propiedades.html">Propiedades</a></li>
        <li><a href="propiedades-mapa.html">Mapa</a></li>
        <li><a href="admin.html" class="active">Admin</a></li>
      </ul>
    </nav>
  </header>

  <main class="section container admin-dashboard">
    <div class="admin-header-row">
      <div>
        <p class="eyebrow">Xarcon Admin</p>
        <h1>Panel de propiedades</h1>
        <p>Administra el catálogo y descarga el <strong>properties.json</strong> actualizado para subirlo al repositorio.</p>
      </div>
    </div>

    <div class="admin-layout">
      <article class="admin-panel">
        <h2>Agregar / editar propiedad</h2>
        <form id="admin-property-form" class="admin-form-grid" data-mode="create">
          <input id="field-id" type="hidden" />
          <label>Título<input id="field-title" type="text" required /></label>
          <label>Precio (USD)<input id="field-price" type="number" min="0" step="1000" required /></label>
          <label>Ubicación<input id="field-location" type="text" required /></label>
          <label>Tipo
            <select id="field-type" required>
              <option value="">Selecciona tipo</option>
              <option value="Casa">House</option>
              <option value="Terreno">Land</option>
              <option value="Apartamento">Apartment</option>
              <option value="Comercial">Commercial</option>
            </select>
          </label>
          <label>Habitaciones<input id="field-bedrooms" type="number" min="0" step="1" value="0" /></label>
          <label>Baños<input id="field-bathrooms" type="number" min="0" step="1" value="0" /></label>
          <label>Área (m²)<input id="field-area" type="number" min="0" step="1" value="0" /></label>
          <label>Latitud<input id="field-latitude" type="number" step="any" /></label>
          <label>Longitud<input id="field-longitude" type="number" step="any" /></label>
          <div class="admin-map-section admin-full-width">
            <div class="admin-map-toolbar">
              <input id="admin-map-search" type="search" placeholder="Buscar ciudad o dirección" aria-label="Buscar ubicación en mapa" />
              <button id="admin-use-map-location" class="btn btn-outline" type="button">Usar ubicación actual del mapa</button>
            </div>
            <p id="admin-live-coordinates" class="admin-live-coordinates">Lat: 12.865400 · Lng: -85.207200</p>
            <div id="admin-property-map" class="admin-property-map" aria-label="Mapa para seleccionar coordenadas"></div>
          </div>
          <label class="admin-full-width">Descripción<textarea id="field-description" rows="4" required></textarea></label>
          <div class="admin-full-width admin-upload-wrapper">
            <p class="admin-upload-label">Imágenes (máx. 3MB por imagen)</p>
            <div id="image-upload-dropzone" class="admin-upload-dropzone" role="button" tabindex="0" aria-label="Arrastra imágenes o haz click para subir">
              <p><strong>Arrastra y suelta imágenes aquí</strong> o haz click para seleccionarlas.</p>
              <p>Formatos soportados: JPG, PNG, WEBP, GIF</p>
              <input id="field-images" type="file" accept="image/*" multiple />
            </div>
            <div class="admin-upload-progress" aria-live="polite">
              <progress id="upload-progress-bar" max="100" value="0"></progress>
              <span id="upload-progress-label">Sin imágenes</span>
            </div>
          </div>
          <div class="admin-image-preview admin-full-width" id="image-preview"></div>
          <div class="admin-actions-row admin-full-width">
            <button class="btn btn-primary" type="submit">Guardar propiedad</button>
            <button id="admin-cancel-edit" class="btn btn-outline" type="button">Cancelar edición</button>
          </div>
        </form>
        <p id="admin-form-status" class="admin-status"></p>
      </article>

      <article class="admin-panel">
        <h2>Listado actual</h2>
        <div class="admin-table-wrap">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Propiedad</th>
                <th>Tipo</th>
                <th>Precio</th>
                <th>Ubicación</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="admin-property-list"></tbody>
          </table>
        </div>
      </article>
    </div>

    <article class="admin-panel admin-json-panel">
      <h2>JSON generado</h2>
      <p>GitHub Pages es estático: este panel no guarda en servidor. Descarga el archivo y reemplázalo en <code>js/properties.json</code>.</p>
      <textarea id="json-preview" rows="18" readonly></textarea>
      <div class="admin-actions-row">
        <button id="download-json" class="btn btn-primary" type="button">Download updated properties.json</button>
      </div>
    </article>
  </main>

  <script src="js/maps-config.js"></script>
  <script src="js/main.js"></script>
  <script src="js/admin-map.js"></script>
  <script src="js/admin-upload.js"></script>
  <script src="js/admin.js"></script>
</body>
</html>
